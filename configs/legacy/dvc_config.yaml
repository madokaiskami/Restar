run_name: dvc_run
random_seed: 42

# Keep the structure aligned with existing configs while pinning deterministic
# paths for DVC. Training will write under outputs/dvc_run/ and any prepare
# stage should emit fixed parquet files in data/raw/.

output_dir: "outputs"

data:
  # Not used directly in the pipeline but kept for structural consistency.
  source: "synthetic"
  categories: ["Synthetic"]

model:
  pretrained_name: "prajjwal1/bert-tiny"
  pretrained_local_dir: "artifacts/pretrained/prajjwal1-bert-tiny"
  num_labels: 3
  max_length: 256

train:
  batch_size: 8
  logging_steps: 2
  learning_rate: 5.0e-5
  num_train_epochs: 1
  weight_decay: 0.01
  warmup_ratio: 0.06
  early_stopping_patience: 2
  save_total_limit: 2
  # Disable Hub pushes in the DVC pipeline for reproducibility without
  # external side effects.
  push_to_hub: false

train_stream:
  enabled: true
  source: "synthetic"
  local_parquet: "data/raw/train.parquet"
  rows:
    - {text: "bad battery life", rating: 1, title: "battery", asin: "a1", product_category: "Synthetic", label: 0}
    - {text: "terrible quality", rating: 1, title: "quality", asin: "a2", product_category: "Synthetic", label: 0}
    - {text: "average performance", rating: 3, title: "ok", asin: "a3", product_category: "Synthetic", label: 1}
    - {text: "works as expected", rating: 3, title: "ok2", asin: "a4", product_category: "Synthetic", label: 1}
    - {text: "great product", rating: 5, title: "great", asin: "a5", product_category: "Synthetic", label: 2}
    - {text: "excellent and reliable", rating: 5, title: "reliable", asin: "a6", product_category: "Synthetic", label: 2}
  per_class_target: 2
  hf_shuffle_buffer: 200
  seed: 42
  dedup: true
  sample_text_min_words: 0
  stop_when_full: true

# Explicit prepare outputs for DVC tracking.
prepare:
  out_train_parquet: "data/raw/train.parquet"
  out_dev_parquet: "data/raw/dev.parquet"
  out_eval_parquet: "data/raw/eval.parquet"

dev:
  source: "synthetic"
  local_parquet: "data/raw/dev.parquet"
  rows:
    - {text: "bad", rating: 1, title: "bad", asin: "d1", product_category: "Synthetic", label: 0}
    - {text: "neutral", rating: 3, title: "neutral", asin: "d2", product_category: "Synthetic", label: 1}
    - {text: "good", rating: 5, title: "good", asin: "d3", product_category: "Synthetic", label: 2}
  max_rows: 0

eval:
  source: "synthetic"
  local_parquet: "data/raw/eval.parquet"
  rows:
    - {text: "horrible", rating: 1, title: "horrible", asin: "e1", product_category: "Synthetic", label: 0}
    - {text: "meh", rating: 3, title: "meh", asin: "e2", product_category: "Synthetic", label: 1}
    - {text: "awesome", rating: 5, title: "awesome", asin: "e3", product_category: "Synthetic", label: 2}
